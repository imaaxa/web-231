<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Gilliam: Exercise 7.4</title>
    <link rel="stylesheet" href="../site.css">
  </head>

  <body>
    <div id="list"></div>

    <script>
      /*
      ============================================
      ; Title: Discussion 7.1
      ; Author: Cory Gilliam
      ; Date: 10 July 2019
      ; Modified By:
      ; Description: Program with two (2) errors
      ;===========================================
      */

      // Functions:
      /**
      * Wrap text with html tag and inject tag with attributes as needed
      * (No errors in here)
      * @param {string} tag
      * @param {string} data
      * @param {string} attributes
      */
      function wrap(tag, data, attributes) {
        // Revision note: Attributes should be a key: value pair array with values being an array
        attributes === undefined ? attributes = '' : attributes = ' ' + attributes;

        return '<' + tag + attributes + '>' + data + '</' + tag + '>' ;
      }

      /**
       * Creates an Employee object
       * (No errors in here)
       * @param {int} id
       * @param {string} firstName
       * @param {string} lastName
       * @param {string} title
       */
      function Employee(id, firstName, lastName, title) {
        this.id = id;
        this.firstName = firstName;
        this.lastName = lastName;
        this.title = title;
        this.name = this.firstName + ' ' + this.lastName;
      }

      /**
       * Handle click events
       * (No errors in here)
       * @param {object} e
       */
      function userNotice(e) {
        e.preventDefault();                          // Stop link from firing
        var id = e.target.attributes.href.value - 1; // Get id from links href attribute and subtract 1
        var message = employees[id].name + ' is a ' + employees[id].title; // Set message
        alert(message);                              // Trigger alert
      }

      // Variables:
      var employees = [
        new Employee(1, "Gandalf", "The Grey", "Wizard"),
        new Employee(2, "Frodo", "Baggins", "Ring Bearer"),
        new Employee(3, "Samwise", "Gamgee", "Best Friend"),
        new Employee(4, "Meriadoc", "Brandybuck", "Friend"),
        new Employee(5, "Peregrin", "Took", "Friend")
      ];
      var domContainer = document.getElementById('list');
      var itemsList = '';

      employees.forEach(employee => {
        itemsList += wrap('li', wrap('a', employee.name, 'href="' + employee.id + '"'));
      });

      // Output:
      domContainer.innerHTML = wrap('ul', itemsList, 'id="employees"');

      // Event Listeners
      var links = domContainer.querySelectorAll("#employees a");

      // Connect an event listener to each link
      links.forEachOne(link => {
        link.addEventListener("click, userNotice, false);
      });

      // End program:
    </script>
  </body>
</html>
